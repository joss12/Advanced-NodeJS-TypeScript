{"version":3,"file":"ResponseViewMiddleware.js","sourceRoot":"","sources":["../../../src/platform/middlewares/ResponseViewMiddleware.ts"],"names":[],"mappings":";;;;AAAA,sEAAiE;AACjE,2EAAsE;AACtE,mEAAyD;AACzD,2EAAsE;AACtE,oFAA+E;AAG/E;;;;;GAKG;AAEH,IAAa,sBAAsB,GAAnC,MAAa,sBAAsB;IACjC,KAAK,CAAC,GAAG,CAAiB,IAAS,EAAkB,QAAsB,EAAS,QAAa;QAC/F,8CAA8C;QAC9C,IAAI;YACF,MAAM,EAAC,IAAI,EAAE,OAAO,EAAC,GAAG,QAAQ,CAAC,IAAI,CAAC;YAEtC,OAAO,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE,CAC3C,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,EAAC,GAAG,OAAO,EAAE,GAAG,IAAI,EAAC,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE;gBAC5D,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YACvC,CAAC,CAAC,CACH,CAAC;SACH;QAAC,OAAO,GAAG,EAAE;YACZ,MAAM,IAAI,+CAAsB,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;SAC9E;IACH,CAAC;CACF,CAAA;AAdC;IAAW,mBAAA,2BAAY,EAAE,CAAA,EAAa,mBAAA,2BAAY,EAAE,CAAA,EAA0B,mBAAA,cAAG,EAAE,CAAA;;;;iDAalF;AAdU,sBAAsB;IADlC,uBAAU,EAAE;GACA,sBAAsB,CAelC;AAfY,wDAAsB","sourcesContent":["import {Middleware} from \"../../mvc/decorators/class/middleware\";\nimport {EndpointInfo} from \"../../mvc/decorators/params/endpointInfo\";\nimport {Res} from \"../../mvc/decorators/params/response\";\nimport {ResponseData} from \"../../mvc/decorators/params/responseData\";\nimport {TemplateRenderingError} from \"../../mvc/errors/TemplateRenderingError\";\nimport {IMiddleware} from \"../../mvc/interfaces/IMiddleware\";\n\n/**\n * Render a view.\n *\n * @middleware\n * @deprecated Will be removed in v6.\n */\n@Middleware()\nexport class ResponseViewMiddleware implements IMiddleware {\n  async use(@ResponseData() data: any, @EndpointInfo() endpoint: EndpointInfo, @Res() response: Res) {\n    // TODO Move this code inside PlatformResponse\n    try {\n      const {path, options} = endpoint.view;\n\n      return await new Promise((resolve, reject) =>\n        response.render(path, {...options, ...data}, (err, content) => {\n          err ? reject(err) : resolve(content);\n        })\n      );\n    } catch (err) {\n      throw new TemplateRenderingError(endpoint.target, endpoint.propertyKey, err);\n    }\n  }\n}\n"]}