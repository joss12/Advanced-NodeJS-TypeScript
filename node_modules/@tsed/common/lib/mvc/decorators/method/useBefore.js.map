{"version":3,"file":"useBefore.js","sourceRoot":"","sources":["../../../../src/mvc/decorators/method/useBefore.ts"],"names":[],"mappings":";;;AAAA,qCAAsH;AACtH,6CAAwC;AAExC;;;;;;;;;;;;;;;;;;;GAmBG;AACH,SAAgB,SAAS,CAAC,GAAG,IAAW;IACtC,OAAO,CAAI,GAAG,aAAkC,EAAqC,EAAE;QACrF,QAAQ,sBAAe,CAAC,aAAa,CAAC,EAAE;YACtC,KAAK,qBAAc,CAAC,MAAM;gBACxB,uBAAU,CAAC,CAAC,QAAQ,EAAE,EAAE;oBACtB,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;gBACxB,CAAC,CAAC,CAAC,GAAI,aAAmD,CAAC,CAAC;gBAE5D,OAAO,aAAa,CAAC,CAAC,CAAQ,CAAC;YACjC,KAAK,qBAAc,CAAC,KAAK;gBACvB,iBAAU,CAAC,aAAa,EAAE,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC;gBAC/D,MAAM;YACR;gBACE,MAAM,IAAI,+BAAwB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;SAChE;IACH,CAAC,CAAC;AACJ,CAAC;AAhBD,8BAgBC","sourcesContent":["import {DecoratorParameters, decoratorTypeOf, DecoratorTypes, StoreMerge, UnsupportedDecoratorType} from \"@tsed/core\";\nimport {EndpointFn} from \"./endpointFn\";\n\n/**\n * Mounts the specified middleware function or functions at the specified path: the middleware function is executed when\n * the base of the requested path matches `path.\n *\n * ```typescript\n * @Controller('/')\n * @UseBefore(Middleware1) // called only one time before all endpoint\n * export class Ctrl {\n *\n *    @Get('/')\n *    @UseBefore(Middleware2)\n *    get() { }\n * }\n * ```\n *\n * @returns {function(any, any, any): *}\n * @param args\n * @decorator\n * @operation\n */\nexport function UseBefore(...args: any[]): Function {\n  return <T>(...decoratorArgs: DecoratorParameters): TypedPropertyDescriptor<T> | void => {\n    switch (decoratorTypeOf(decoratorArgs)) {\n      case DecoratorTypes.METHOD:\n        EndpointFn((endpoint) => {\n          endpoint.before(args);\n        })(...(decoratorArgs as [any, string, PropertyDescriptor]));\n\n        return decoratorArgs[2] as any;\n      case DecoratorTypes.CLASS:\n        StoreMerge(\"middlewares\", {useBefore: args})(...decoratorArgs);\n        break;\n      default:\n        throw new UnsupportedDecoratorType(UseBefore, decoratorArgs);\n    }\n  };\n}\n"]}